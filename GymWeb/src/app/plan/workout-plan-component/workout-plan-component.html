<div class="workout-container">
  <div class="workout-header">
    <div class="header-content">
      <h1><i class="fas fa-dumbbell"></i> Your Workout Plan</h1>
      <p *ngIf="userProfile && workoutPlan">
        {{ workoutPlan.planType | titlecase }} plan for {{ userProfile.name }} -
        {{ workoutPlan.difficultyLevel | titlecase }} level
      </p>
    </div>
    <div class="header-actions">
      <button
        (click)="regenerateWorkoutPlan()"
        [disabled]="isLoading"
        class="action-btn"
      >
        <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i> Regenerate
        Workout Plan
      </button>
      <button routerLink="/plan-dashboard" class="action-btn secondary">
        <i class="fas fa-home"></i> Dashboard
      </button>
    </div>
  </div>

  <!-- Weekly Schedule -->
  <div *ngIf="workoutPlan?.weeklyPlan?.length" class="weekly-overview">
    <h3><i class="fas fa-calendar-alt"></i> Weekly Schedule</h3>
    <div class="week-grid">
      <div
        *ngFor="let day of workoutPlan?.weeklyPlan ?? []; let i = index"
        (click)="selectDay(i)"
        class="week-day"
        [class.active]="selectedDayIndex === i"
        [class.rest-day]="day.restDay"
      >
        <div class="day-header">
          <span class="day-name">{{ day.dayName }}</span>
          <div class="day-badge" [class.rest-badge]="day.restDay">
            <i class="fas" [class]="'fa-' + getFocusIcon(day.focusArea)"></i>
          </div>
        </div>

        <div *ngIf="!day.restDay" class="day-content">
          <span class="focus-area">{{
            day.focusArea.replace("_", " ") | titlecase
          }}</span>
          <span>{{ day.exercises.length || 0 }} exercises</span>
          <div class="day-stats">
            <div class="duration">
              <i class="fas fa-clock"></i>
              {{ day.estimatedDurationMinutes || 0 }} min
            </div>
            <div class="calories-burned">
              <i class="fas fa-fire"></i> {{ day.totalCaloriesBurned || 0 }}
            </div>
          </div>
        </div>

        <div *ngIf="day.restDay" class="day-content rest-label">
          Rest day - take time to recover!
        </div>
      </div>
    </div>
  </div>

  <!-- Selected Day Exercises -->
  <div *ngIf="selectedDay" class="day-summary">
    <h3 *ngIf="!selectedDay.restDay">
      Exercises for {{ selectedDay.dayName }}
    </h3>
    <div *ngIf="!selectedDay.restDay" class="exercises-list">
      <div
        *ngFor="let ex of selectedDay.exercises || []; let i = index"
        class="exercise-card"
      >
        <div class="exercise-header" (click)="toggleExerciseDetails(i)">
          <div class="exercise-number">{{ i + 1 }}</div>
          <div class="exercise-info">
            <h3>{{ ex.exerciseName }}</h3>
            <div class="exercise-meta">
              <span
                class="muscle-group"
                [style.background-color]="getMuscleColor(ex.muscleGroup)"
                >{{ ex.muscleGroup | titlecase }}</span
              >
              <span class="equipment">
                <i
                  class="fas"
                  [class]="'fa-' + getEquipmentIcon(ex.equipment)"
                ></i>
                {{ ex.equipment.replace("_", " ") | titlecase }}
              </span>
              <span class="difficulty">{{ ex.difficulty | titlecase }}</span>
            </div>
          </div>
          <div class="exercise-stats">
            <div class="stat">
              <div class="stat-value">{{ ex.sets }}</div>
              <div class="stat-label">Sets</div>
            </div>
            <div class="stat" *ngIf="ex.reps > 0">
              <div class="stat-value">{{ ex.reps }}</div>
              <div class="stat-label">Reps</div>
            </div>
            <div class="stat" *ngIf="ex.durationMinutes > 0">
              <div class="stat-value">{{ ex.durationMinutes }}m</div>
              <div class="stat-label">Duration</div>
            </div>
            <div class="stat">
              <div class="stat-value">{{ ex.restSeconds }}s</div>
              <div class="stat-label">Rest</div>
            </div>
            <div class="stat">
              <div class="stat-value">
                {{ ex.caloriesBurned | number : "1.0-0" }}
              </div>
              <div class="stat-label">Cal</div>
            </div>
            <i
              class="fas fa-chevron-down expand-icon"
              [class.expanded]="isExerciseExpanded(i)"
            ></i>
          </div>
        </div>
        <div *ngIf="isExerciseExpanded(i)" class="exercise-details">
          <div class="exercise-description">
            <h4><i class="fas fa-info-circle"></i> Description</h4>
            <p>{{ ex.description }}</p>
          </div>
          <div class="exercise-instructions">
            <h4><i class="fas fa-clipboard-list"></i> Instructions</h4>
            <p>{{ ex.instructions }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Rest Day Message -->
    <div *ngIf="selectedDay.restDay" class="rest-day-card">
      <div class="rest-content">
        <i class="fas fa-bed"></i>
        <h2>{{ selectedDay.dayName }} - Rest & Recovery</h2>
        <p>
          Your body needs time to repair and grow stronger. Take this day for
          active recovery or rest.
        </p>
        <div class="rest-tips">
          <div class="tip">
            <i class="fas fa-walking"></i><span>Light Walking</span>
          </div>
          <div class="tip">
            <i class="fas fa-spa"></i><span>Stretching</span>
          </div>
          <div class="tip">
            <i class="fas fa-heart"></i><span>Meditation</span>
          </div>
          <div class="tip">
            <i class="fas fa-bath"></i><span>Hot Bath</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Data -->
  <div *ngIf="!workoutPlan && !isLoading" class="no-data">
    <div class="no-data-content">
      <i class="fas fa-dumbbell"></i>
      <h2>No Workout Plan Found</h2>
      <p>Please generate your workout plan from the dashboard.</p>
      <button class="primary-btn" routerLink="/plan-dashboard">
        <i class="fas fa-home"></i> Go to Dashboard
      </button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Loading workout plan...</p>
    </div>
  </div>
</div>
